## uchet-kontora — веб-приложение для риелторской компании (React + Express + MySQL)

**Кратко (30 сек):** клиент-серверное приложение с ролями клиент/агент/админ: авторизация, объявления (CRUD), избранное, карточка квартиры и контакт с агентом. Изначально курсовая, сейчас развиваю как pet-project.

**Origin & статус.** Проект стартовал как ранняя учебная работа под дедлайн. Сейчас веду переработку под более высокие стандарты: безопасность (bcrypt/argon2, JWT, .env), согласование контрактов API, миграции БД, базовые тесты и CI. Ниже — технический долг и план.

## Демо / скриншоты
- Деплой: _добавь ссылку (Netlify)_
- Скриншоты: `./docs/screenshots/`

## Стек
- **Frontend:** React 18 (CRA), MUI
- **Backend:** Node.js, Express.js (REST), CORS 
- **База Данных:** MySQL
- **Авторизация:** JWT (jsonwebtoken)
- **Качество:** ESLint

## Фичи (то, что есть сейчас)
- Регистрация / вход, личный кабинет
- Объявления: список, карточка (галерея/описание/контакт с агентом)
- Избранное: добавить/удалить
- Фильтры по объявлениям (в процессе)
- Навигация с клавиатуры (Tab/Enter), видимые фокус-стейты

> Примечание: приложение использует простой способ шифрования пароля через встроенную библиотеку crypto и секретный ключ (требования к безопасности были не строгие). Будет исправленно в будущем.
> **Важно:** на клиенте базовый URL сейчас указывался на http://localhost:3000, а сервер слушает :5000. Также на бэкенде префикс авторизации — /auth/* (нужно синхронизировать вызовы клиента).

## Архитектура (кратко)
```
server/
  models/
    Agent.js          # SQL CRUD: agents
    ...               # другие сущности (пользователи, квартиры, объявления и т.д.)
  profile/
    registration.js   # демо-логика регистрации/логина (HMAC + JWT) → под замену
  routes/
    agentRoutes.js
    apartmentRoutes.js
    authRoutes.js            # POST /auth/register, POST /auth/login, GET /auth/profile (JWT)
    clientRoutes.js
    favoriteRoutes.js
    listingRoutes.js
    transactionRoutes.js
    userRoutes.js
  config.js           # Подключение к БД
  index.js            # Запуск сервера
src/
  components/
    Header.js     # header
    Header.css    # визуальная часть header
  pages/
    ApartmentDetail.js    # карточка квартиры
    ApartmentDetail.css   # Дизайн карточки квартиры 
    ApartmentList.js      # Страница со всеми объявлениями
    Home.js               # Начльная "домашняя" страница
    Login.js              # Страница входа
    Profile.js            # Страница профиля
    Register.js           # Страница регистрация
  api.js     # взаимодействие с сервером
  App.jsx        # localStorage для токена + навигация
  index.css
```

## Переменные окружения
Используется секретный ключ для хеширования пароля:
```bash
const SECRET_KEY = SECRET_KEY
```
> Ключ может быть любым, но он должен совпадать с ключом, использовавшимся для создания старых записей для получения к ним доступа.
> Секреты и доступы **не храним в коде**. Значения в `.env`, а в репозитории — только `.env.example`.
> **Важно:** система будет перенесена на bcrypt с 12 солями + .env. 

## Метрики (цели для мобильных)
- Lighthouse: **90–100**
- Web Vitals: **LCP < 2.0 s**, **CLS ~ 0.01**
- Bundle: **≤ 300 KB**
> Скриншоты с Lighthouse положи в `./docs/screenshots/`.

## Доступность (A11y)
- Клавиатурная навигация и видимые focus states
- Alt-тексты у фото в карточке квартиры
- ARIA-метки у форм (логин/регистрация/фильтры)

## Безопасность
- **Пароли:** заменить текущий HMAC (crypto) на bcrypt/argon2 + соль
- **JWT:** httpOnly cookie или Bearer, проверка ролей на сервере
- **Конфиги:** все секреты и доступы — только через ```.env```

## Технический долг (что нужно исправить)
- HMAC SHA256 для паролей → bcrypt/argon2
- Секреты/ключи в коде → в ```.env``` (+ ```server/.env```)
- Несовпадающие пути у auth: клиент ```/login```/```/register``` ↔ сервер ```/auth/*```
- Нет миграций/сидов БД; нет e2e/CI; нет мониторинга ошибок

## Roadmap
- [ ] Auth/Security: bcrypt + JWT httpOnly; вынести секреты в ```.env```;
- [ ] API: единый префикс ```/auth/*```, ```/listings``` с фильтрами/пагинацией; индексы в БД
- [ ] Документация: ```docs/API.md```, ER-диаграмма (```docs/db.png```)
- [ ] Тесты: unit (утилиты) + e2e (флоу «избранное → контакт агенту»)
- [ ] CI: GitHub Actions (lint/test/build), Lighthouse-скрины
- [ ] Деплой: front (Netlify/Vercel) + API (Render/Railway) + DB (PlanetScale/Neon/Neon)

## Цель проекта
Показать end-to-end разработку на клиент-серверной архитектуре: UI/UX → авторизация/роли → REST API → БД → производительность и деплой.

## Запуск
```bash
# Backend
cd server
# при первом запуске проверь, что MySQL доступен и БД "rieltor" создана
node index.js   # http://localhost:5000

# Frontend
npm i
npm start       # http://localhost:3000
```
